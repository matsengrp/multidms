<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>&lt;no title&gt; &#8212; multidms 0.3.3 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=420b4293" />
    <script src="_static/documentation_options.js?v=d5a15cff"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="plot" href="multidms.plot.html" />
    <link rel="prev" title="model" href="multidms.model.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <p id="module-multidms.model_collection">Contains the ModelCollection class, which takes a collection of models
and merges the results for comparison and visualization.</p>
<dl class="py exception">
<dt class="sig sig-object py" id="multidms.model_collection.ModelCollectionFitError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">multidms.model_collection.</span></span><span class="sig-name descname"><span class="pre">ModelCollectionFitError</span></span><a class="headerlink" href="#multidms.model_collection.ModelCollectionFitError" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#Exception" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></a></p>
<p>Error fitting models.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="multidms.model_collection.fit_one_model">
<span class="sig-prename descclassname"><span class="pre">multidms.model_collection.</span></span><span class="sig-name descname"><span class="pre">fit_one_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">huber_scale_huber</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_coeff_lasso_shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_coeff_ridge_beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_coeff_ridge_shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_coeff_ridge_gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_coeff_ridge_alpha_d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epistatic_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Sigmoid'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Identity'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lock_beta_naught_at</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma_corrected</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_beta_naught</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_training_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterations_per_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hidden_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lower_bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PRNGKey</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#multidms.model_collection.fit_one_model" title="Link to this definition">¶</a></dt>
<dd><p>Fit a multidms model to a dataset. This is a wrapper around the multidms
fit method that allows for easy specification of the fit parameters.
This method is helpful for comparing and organizing multiple fits.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<a class="reference internal" href="multidms.html#multidms.Data" title="multidms.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">multidms.Data</span></code></a>) – The dataset to fit to. For bookkeeping and downstream analysis,
the name of the dataset (Data.name) is saved in the fit attributes
that are returned.</p></li>
<li><p><strong>huber_scale_huber</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><em>optional</em>) – The scale of the huber loss function. The default is 1.</p></li>
<li><p><strong>scale_coeff_lasso_shift</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><em>optional</em>) – The scale of the lasso penalty on the shift parameter. The default is 2e-5.</p></li>
<li><p><strong>scale_coeff_ridge_beta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><em>optional</em>) – The scale of the ridge penalty on the beta parameter. The default is 0.</p></li>
<li><p><strong>scale_coeff_ridge_shift</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><em>optional</em>) – The scale of the ridge penalty on the shift parameter. The default is 0.</p></li>
<li><p><strong>scale_coeff_ridge_gamma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><em>optional</em>) – The scale of the ridge penalty on the gamma parameter. The default is 0.</p></li>
<li><p><strong>scale_coeff_ridge_alpha_d</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><em>optional</em>) – The scale of the ridge penalty on the ch parameter. The default is 0.</p></li>
<li><p><strong>epistatic_model</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – The epistatic model to use. The default is “Identity”.</p></li>
<li><p><strong>output_activation</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – The output activation function to use. The default is “Identity”.</p></li>
<li><p><strong>lock_beta_naught_at</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em> or </em><em>None optional</em>) – The value to lock the beta_naught parameter to. If None,
the beta_naught parameter is free to vary. The default is None.</p></li>
<li><p><strong>gamma_corrected</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to use the gamma corrected model. The default is True.</p></li>
<li><p><strong>alpha_d</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to use the conditional c model. The default is False.</p></li>
<li><p><strong>init_beta_naught</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><em>optional</em>) – The initial value of the beta_naught parameter. The default is 0.0.
Note that is lock_beta_naught is not None, then this value is irrelevant.</p></li>
<li><p><strong>tol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><em>optional</em>) – The tolerance for the fit. The default is 1e-3.</p></li>
<li><p><strong>num_training_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>optional</em>) – The number of training steps to perform. The default is 1.
If you would like to see training loss throughout training,
divide the number of total iterations by the number of steps.
In other words, if you specify 1 for num_training_steps and
20000 for iterations_per_step, that would be equivalent to
specifying 20 for num_training_steps and 1000 for iterations_per_step,
except that the latter will populate the step_loss attribute
with the loss at the beginning each step.</p></li>
<li><p><strong>iterations_per_step</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>optional</em>) – The number of iterations to perform per training step. The default is 20000.</p></li>
<li><p><strong>n_hidden_units</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>optional</em>) – The number of hidden units to use in the neural network model. The default is 5.</p></li>
<li><p><strong>lower_bound</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><em>optional</em>) – The lower bound for use with the softplus activation function.
The default is None, but must be specified if using the softplus activation.</p></li>
<li><p><strong>PRNGKey</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>optional</em>) – The PRNGKey to use to initialize model parameters. The default is 0.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to print out information about the fit to stdout. The default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fit_series</strong> – A series containing reference to the fit <cite>multidms.Model</cite> object
and the associated parameters used for the fit.
These consist mostly of the keyword arguments passed to this function,
less “verbose”, and with the addition of:
1. “model” - the fit <cite>multidms.Model</cite> object reference,
2. “dataset_name” which will simply be the name associated with the <cite>Data</cite>
object
used for training (note that the <cite>multidms.Data</cite> object itself is always
accessible via the <cite>Model.data</cite> attribute).
3. “step_loss” which is a numpy array of the loss at the end of each training
epoch.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.2.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.Series</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="multidms.model_collection.stack_fit_models">
<span class="sig-prename descclassname"><span class="pre">multidms.model_collection.</span></span><span class="sig-name descname"><span class="pre">stack_fit_models</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fit_models_list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#multidms.model_collection.stack_fit_models" title="Link to this definition">¶</a></dt>
<dd><p>given a list of pd.Series objects returned by fit_one_model,
stack them into a single pd.DataFrame</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="multidms.model_collection.fit_models">
<span class="sig-prename descclassname"><span class="pre">multidms.model_collection.</span></span><span class="sig-name descname"><span class="pre">fit_models</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_threads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">failures</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'error'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#multidms.model_collection.fit_models" title="Link to this definition">¶</a></dt>
<dd><p>Fit collection of <a class="reference internal" href="multidms.html#multidms.Model" title="multidms.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a> models.</p>
<p>Enables fitting of multiple models simultaneously using multiple threads.
The returned dataframe is meant to be passed into the
<a class="reference internal" href="multidms.html#multidms.ModelCollection" title="multidms.ModelCollection"><code class="xref py py-class docutils literal notranslate"><span class="pre">multidms.ModelCollection</span></code></a> class for comparison and visualization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a>) – Dictionary which defines the parameter space of all models you
wish to run. Each value in the dictionary must be a list of
values, even in the case of singletons.
This function will compute all combinations of the parameter
space and pass each combination to <code class="xref py py-func docutils literal notranslate"><span class="pre">multidms.utils.fit_wrapper()</span></code>
to be run in parallel, thus only key-value pairs which
match the kwargs are allowed.
See the docstring of <code class="xref py py-func docutils literal notranslate"><span class="pre">multidms.utils.fit_wrapper()</span></code> for
a description of the allowed kwargs.</p></li>
<li><p><strong>n_threads</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of threads (CPUs, cores) to use for fitting. Set to -1 to use
all CPUs available.</p></li>
<li><p><strong>failures</strong> (<em>{&quot;error&quot;</em><em>, </em><em>&quot;tolerate&quot;}</em>) – What if fitting fails for a model? If “error” then raise an error,
if “ignore” then just return <cite>None</cite> for models that failed optimization.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Number of models that fit successfully, number of models that failed,
and a dataframe which contains a row for each of the <cite>multidms.Model</cite>
object references along with the parameters each was fit with for convenience.
The dataframe is ultimately meant to be passed into the ModelCollection class.
for comparison and visualization.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(n_fit, n_failed, fit_models)</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="multidms.model_collection.ModelCollection">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">multidms.model_collection.</span></span><span class="sig-name descname"><span class="pre">ModelCollection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fit_models</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#multidms.model_collection.ModelCollection" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A class for the comparison and visualization of multiple
<cite>multidms.Model</cite> fits. The respective collection of
training datasets for each fit must
share the same reference sequence and conditions. Additionally,
the inferred site maps must agree upon condition wildtypes
for all shared sites.</p>
<p>The utility function <cite>multidms.model_collection.fit_models</cite> is used to fit
the collection of models, and the resulting dataframe is passed to the
constructor of this class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fit_models</strong> (<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.2.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a>) – A dataframe containing the fit attributes and pickled model objects
as returned by <cite>multidms.model_collection.fit_models</cite>.</p>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="multidms.model_collection.ModelCollection.fit_models">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fit_models</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.2.0)"><span class="pre">DataFrame</span></a></em><a class="headerlink" href="#multidms.model_collection.ModelCollection.fit_models" title="Link to this definition">¶</a></dt>
<dd><p>The dataframe containing the fit attributes and pickled model objects.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="multidms.model_collection.ModelCollection.site_map_union">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">site_map_union</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.2.0)"><span class="pre">DataFrame</span></a></em><a class="headerlink" href="#multidms.model_collection.ModelCollection.site_map_union" title="Link to this definition">¶</a></dt>
<dd><p>The union of all site maps of all datasets used for fitting.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="multidms.model_collection.ModelCollection.conditions">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">conditions</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><span class="pre">list</span></a></em><a class="headerlink" href="#multidms.model_collection.ModelCollection.conditions" title="Link to this definition">¶</a></dt>
<dd><p>The conditions (shared by each fitting dataset) used for fitting.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="multidms.model_collection.ModelCollection.reference">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">reference</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></em><a class="headerlink" href="#multidms.model_collection.ModelCollection.reference" title="Link to this definition">¶</a></dt>
<dd><p>The reference conditions (shared by each fitting dataset) used for fitting.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="multidms.model_collection.ModelCollection.shared_mutations">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shared_mutations</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)"><span class="pre">tuple</span></a></em><a class="headerlink" href="#multidms.model_collection.ModelCollection.shared_mutations" title="Link to this definition">¶</a></dt>
<dd><p>The mutations shared by each fitting dataset.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="multidms.model_collection.ModelCollection.all_mutations">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">all_mutations</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)"><span class="pre">tuple</span></a></em><a class="headerlink" href="#multidms.model_collection.ModelCollection.all_mutations" title="Link to this definition">¶</a></dt>
<dd><p>The mutations shared by each fitting dataset.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="multidms.model_collection.ModelCollection.split_apply_combine_muts">
<span class="sig-name descname"><span class="pre">split_apply_combine_muts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">groupby</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('dataset_name',</span> <span class="pre">'scale_coeff_lasso_shift')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregate_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inner_merge_dataset_muts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#multidms.model_collection.ModelCollection.split_apply_combine_muts" title="Link to this definition">¶</a></dt>
<dd><p>wrapper to split-apply-combine the set of mutational dataframes
harbored by each of the fits in the collection.</p>
<p>here, we split the collection by grouping certain attributes, such
as dataset name, or the scaling coefficient of the lasso penalty.
Each of those groups may then be filtered and aggregated, before
the function stacks all the groups back together in a
tall style dataframe. The resulting dataframe will have a multiindex
with the mutation and the groupby attributes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>groupby</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)"><em>tuple</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em> or </em><em>None</em><em>, </em><em>optional</em>) – The attributes to group the fits by. If None, then group by all
attributes except for the model, data, step_loss, and verbose attributes.
The default is (“dataset_name”, “scale_coeff_lasso_shift”).</p></li>
<li><p><strong>aggregate_func</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em> or </em><em>callable</em><em>, </em><em>optional</em>) – The function to aggregate the mutational dataframes within each group.
The default is “mean”.</p></li>
<li><p><strong>inner_merge_dataset_muts</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to toss mutations which are _not_ shared across all datasets
before aggregation of group mutation parameter values.
The default is True.</p></li>
<li><p><strong>query</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – The pandas query to apply to the <cite>ModelCollection.fit_models</cite>
dataframe before splitting. The default is None.</p></li>
<li><p><strong>**kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a>) – Keyword arguments to pass to the <a class="reference internal" href="multidms.html#multidms.Model.get_mutations_df" title="multidms.Model.get_mutations_df"><code class="xref py py-func docutils literal notranslate"><span class="pre">multidms.Model.get_mutations_df()</span></code></a>
method (“phenotype_as_effect”, and “times_seen_threshold”) see the
method docstring for details.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dataframe containing the aggregated mutational parameter values</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.2.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="multidms.model_collection.ModelCollection.mut_param_heatmap">
<span class="sig-name descname"><span class="pre">mut_param_heatmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mut_param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'shift'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregate_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inner_merge_dataset_muts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">times_seen_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phenotype_as_effect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#multidms.model_collection.ModelCollection.mut_param_heatmap" title="Link to this definition">¶</a></dt>
<dd><p>Create lineplot and heatmap altair chart
across replicate datasets.
This function optionally applies a given <cite>pandas.query</cite>
on the fit_models dataframe that should result in a subset of
fit’s which make sense to aggregate mutational data across, e.g.
replicate datasets.
It then computes the mean or median mutational parameter value
(“beta”, “shift”, or “predicted_func_score”)
between the remaining fits. and creates an interactive altair chart.</p>
<p>Note that this will throw an error if the queried fits have more
than one unique hyper-parameter besides “dataset_name”.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – The query to apply to the fit_models dataframe. This should be
used to subset the fits to only those which make sense to aggregate
mutational data across, e.g. replicate datasets.
For example, if you have a collection of
fits with different epistatic models, you may want to query
for only those fits with the same epistatic model. e.g.
<cite>query=”epistatic_model == ‘Sigmoid’”</cite>. For more on the query
syntax, see the
<a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.query.html">pandas.query</a>
documentation.</p></li>
<li><p><strong>mut_param</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – The mutational parameter to plot. The default is “shift”.
Must be one of “shift”, “predicted_func_score”, or “beta”.</p></li>
<li><p><strong>aggregate_func</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – The function to aggregate the mutational parameter values
between dataset fits. The default is “mean”.</p></li>
<li><p><strong>inner_merge_dataset_muts</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to toss mutations which are _not_ shared across all datasets
before aggregation of group mutation parameter values.
The default is True.</p></li>
<li><p><strong>times_seen_threshold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>optional</em>) – The minimum number of times a mutation must be seen across
all conditions within a single fit to be included in the
aggregation. The default is 0.</p></li>
<li><p><strong>phenotype_as_effect</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Passed to <cite>Model.get_mutations_df()</cite>,
Only applies if <cite>mut_param=”predicted_func_score”</cite>.</p></li>
<li><p><strong>**kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a>) – Keyword arguments to pass to
<code class="xref py py-func docutils literal notranslate"><span class="pre">multidms.plot._lineplot_and_heatmap()</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A chart object which can be displayed in a jupyter notebook
or saved to a file.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>altair.Chart</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="multidms.model_collection.ModelCollection.mut_param_traceplot">
<span class="sig-name descname"><span class="pre">mut_param_traceplot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mutations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mut_param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'shift'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'scale_coeff_lasso_shift'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width_scalar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height_scalar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#multidms.model_collection.ModelCollection.mut_param_traceplot" title="Link to this definition">¶</a></dt>
<dd><p>visualize mutation parameter values across the lasso penalty weights
(by default) of a given subset of the mutations in the form of an
<cite>altair.FacetChart</cite>. This is useful when you would like to confirm
that a reported mutational parameter value carries through across the
individual fits.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A chart object which can be displayed in a jupyter notebook
or saved to a file.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>altair.Chart</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="multidms.model_collection.ModelCollection.shift_sparsity">
<span class="sig-name descname"><span class="pre">shift_sparsity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'scale_coeff_lasso_shift'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width_scalar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height_scalar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#multidms.model_collection.ModelCollection.shift_sparsity" title="Link to this definition">¶</a></dt>
<dd><p>Visualize shift parameter set sparsity across the lasso penalty weights
(by default) in the form of an <cite>altair.FacetChart</cite>.
We will group the mutations according to their status as either a
a “stop” (e.g. A15*), or “nonsynonymous” (e.g. A15G) mutation before calculating
the sparsity. This is because in a way, mutations to stop codons act as a
False positive rate, as we expect their mutational effect to be equally
deleterious in all experiments, and thus have a shift parameter value of zero.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A chart object which can be displayed in a jupyter notebook
or saved to a file.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>altair.Chart</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="multidms.model_collection.ModelCollection.mut_param_dataset_correlation">
<span class="sig-name descname"><span class="pre">mut_param_dataset_correlation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'scale_coeff_lasso_shift'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mut_param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'shift'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width_scalar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">150</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#multidms.model_collection.ModelCollection.mut_param_dataset_correlation" title="Link to this definition">¶</a></dt>
<dd><p>Visualize the correlation between replicate datasets across the lasso penalty
weights (by default) in the form of an <cite>altair.FacetChart</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A chart object which can be displayed in a jupyter notebook
or saved to a file.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>altair.Chart</p>
</dd>
</dl>
</dd></dl>

</dd></dl>



          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="index.html">
    <img class="logo" src="_static/2020-logo-1000px-transparent.png" alt="Logo" />
    
    <h1 class="logo logo-name">multidms</h1>
    
  </a>
</p>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=matsengrp&repo=multidms&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html">multidms documentation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="biophysical_model.html">Biophysical model</a></li>
<li class="toctree-l1"><a class="reference internal" href="fit_delta_BA1_example.html"><code class="docutils literal notranslate"><span class="pre">multidms</span></code> usage examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="multidms.html">multidms package</a></li>
<li class="toctree-l1"><a class="reference internal" href="acknowledgments.html">Acknowledgments</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="multidms.html">multidms package</a><ul>
      <li>Previous: <a href="multidms.model.html" title="previous chapter">model</a></li>
      <li>Next: <a href="multidms.plot.html" title="next chapter">plot</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2023, Jared Galloway, Hugh Haddox.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="_sources/multidms.model_collection.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>