<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>plot &#8212; multidms 0.1.9 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Utils" href="multidms.utils.html" />
    <link rel="prev" title="model" href="multidms.model.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <span class="target" id="module-multidms.plot"></span><section id="plot">
<h1>plot<a class="headerlink" href="#plot" title="Permalink to this heading">¶</a></h1>
<p>Plotting functions.</p>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="multidms.plot.color_gradient_hex">
<span class="sig-prename descclassname"><span class="pre">multidms.plot.</span></span><span class="sig-name descname"><span class="pre">color_gradient_hex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#multidms.plot.color_gradient_hex" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a list of colors linearly spanning a range.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – Starting color.</p></li>
<li><p><strong>end</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – Ending color.</p></li>
<li><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – Number of colors in list.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of hex codes for colors spanning <cite>start</cite> to <cite>end</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)">list</a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">multidms.plot</span> <span class="k">as</span> <span class="nn">mplt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mplt</span><span class="o">.</span><span class="n">color_gradient_hex</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">[&#39;#ffffff&#39;, &#39;#ffbfbf&#39;, &#39;#ff8080&#39;, &#39;#ff4040&#39;, &#39;#ff0000&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="multidms.plot.lineplot_and_heatmap">
<span class="sig-prename descclassname"><span class="pre">multidms.plot.</span></span><span class="sig-name descname"><span class="pre">lineplot_and_heatmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stat_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">category_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alphabet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sites</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">addtl_tooltip_stats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">addtl_slider_stats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_floor_at_zero</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_site_statistic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sum'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lineplot_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">690</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lineplot_height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">site_zoom_bar_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">site_zoom_bar_color_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_single_category_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">category_colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">heatmap_negative_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">heatmap_color_scheme</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">heatmap_color_scheme_mid_0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">heatmap_max_at_least</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">heatmap_min_at_least</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">site_zoom_bar_color_scheme</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'set3'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slider_binding_range_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">category_prefix_as_replicate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">categorical_wildtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#multidms.plot.lineplot_and_heatmap" title="Permalink to this definition">¶</a></dt>
<dd><p>Lineplots and heatmaps of per-site and per-mutation values.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This code is _mostly_ from <code class="docutils literal notranslate"><span class="pre">polyclonal</span></code>, but modified for use with <code class="docutils literal notranslate"><span class="pre">multidms</span></code></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_df</strong> (<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.0.3)"><em>pandas.DataFrame</em></a>) – Data to plot. Must have columns “site”, “wildtype”, “mutant”, <cite>stat_col</cite>, and
<cite>category_col</cite>. The wildtype values (wildtype = mutant) should be included,
but are not used for the slider filtering or included in site summary lineplot.</p></li>
<li><p><strong>stat_col</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – Column in <cite>data_df</cite> with statistic to plot.</p></li>
<li><p><strong>category_col</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – Column in <cite>data_df</cite> with category to facet plots over. You can just create
a dummy column with some dummy value if you only have one category.</p></li>
<li><p><strong>alphabet</strong> (<em>array-like</em><em> or </em><em>None</em>) – Alphabet letters in order. If <cite>None</cite>, use natsorted “mutant” col of <cite>data_df</cite>.</p></li>
<li><p><strong>sites</strong> (<em>array-like</em><em> or </em><em>None</em>) – Sites in order. If <cite>None</cite>, use natsorted “site” col of <cite>data_df</cite>.</p></li>
<li><p><strong>addtl_tooltip_stats</strong> (<em>None</em><em> or </em><em>array-like</em>) – Additional mutation-level stats to show in the heatmap tooltips. Values in
<cite>addtl_slider_stats</cite> automatically included.</p></li>
<li><p><strong>addtl_slider_stats</strong> (<em>None</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><em>dict</em></a>) – Additional stats for which to have a slider, value is initial setting. Ignores
wildtype and drops it when all mutants have been dropped at site. Null values
are not filtered.</p></li>
<li><p><strong>init_floor_at_zero</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – Initial value for option to put floor of zero on value is <cite>stat_col</cite>.</p></li>
<li><p><strong>init_site_statistic</strong> (<em>{'sum'</em><em>, </em><em>'mean'</em><em>, </em><em>'max'</em><em>, </em><em>'min'}</em>) – Initial value for site statistic in lineplot, calculated from <cite>stat_col</cite>.</p></li>
<li><p><strong>cell_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – Size of cells in heatmap</p></li>
<li><p><strong>lineplot_width</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em> or </em><em>None</em>) – Overall width of lineplot.</p></li>
<li><p><strong>lineplot_height</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – Height of line plot.</p></li>
<li><p><strong>site_zoom_bar_width</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – Width of site zoom bar.</p></li>
<li><p><strong>site_zoom_bar_color_col</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – Column in <cite>data_df</cite> with which to color zoom bar. Must be the same for all
entries for a site.</p></li>
<li><p><strong>plot_title</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em> or </em><em>None</em>) – Overall plot title.</p></li>
<li><p><strong>show_single_category_label</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – Show the category label if just one category.</p></li>
<li><p><strong>category_colors</strong> (<em>None</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><em>dict</em></a>) – Map each category to its color, or None to use default. These are the
colors for <strong>positive</strong> values of <cite>stat_col</cite>.</p></li>
<li><p><strong>heatmap_negative_color</strong> (<em>None</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – Color used for negative values in heatmaps, or None to use default.</p></li>
<li><p><strong>heatmap_color_scheme</strong> (<em>None</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – Heatmap uses this <a class="reference external" href="https://vega.github.io/vega/docs/schemes">Vega scheme</a>
rather than <cite>category_colors</cite> and <cite>heatmap_negative_color</cite>.</p></li>
<li><p><strong>heatmap_color_scheme_mid_0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – Set the heatmap color scheme so the domain mid is zero.</p></li>
<li><p><strong>heatmap_max_at_least</strong> (<em>None</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – Make heatmap color max at least this large.</p></li>
<li><p><strong>heatmap_min_at_least</strong> (<em>None</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – Make heatmap color min at least this small, but still set to 0 if floor of zero
selected.</p></li>
<li><p><strong>site_zoom_bar_color_scheme</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – If using <cite>site_zoom_bar_color_col</cite>, the
<a class="reference external" href="https://vega.github.io/vega/docs/schemes">Vega color scheme</a> to use.</p></li>
<li><p><strong>slider_binding_range_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><em>dict</em></a>) – Keyed by keys in <code class="docutils literal notranslate"><span class="pre">addtl_slider_stats</span></code>, with values being dicts
giving keyword arguments passed to <code class="docutils literal notranslate"><span class="pre">altair.binding_range</span></code> (eg,
‘min’, ‘max’, ‘step’, etc.</p></li>
<li><p><strong>category_prefix_as_replicate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – The first part of the category will be treated as a key on which to
merge conditions as if they were replicates. Any number of replicates
can be matched with any given category. The replicates will be combined
using an inner merge, and tooltips will be added to each point
showing the average value of all replicates.</p></li>
<li><p><strong>categorical_wildtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – if true, then the columns that are prefixed with ‘wildtype’ and
follow with a suffix matching a specific condition, then the heatmaps
will be labeled with points at all non identical sites when compared
with the ‘wildtype’ column (which will be used to mark ‘x’ on each category
heatmap).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="multidms.plot.mut_shift_plot">
<span class="sig-prename descclassname"><span class="pre">multidms.plot.</span></span><span class="sig-name descname"><span class="pre">mut_shift_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fit_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">biochem_order_aas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">times_seen_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#multidms.plot.mut_shift_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Make plot of mutation escape values for one or more replicate fits.
You may either pass a single <cite>multidms.Data</cite> object for
visualizing a single set of parameters or a collection of replicate
fits in the form of a dictionary where key’s are the replicate
name (i.e. rep1, rep2) and values are the respective model objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fit_data</strong> (<a class="reference internal" href="multidms.html#multidms.Data" title="multidms.Data"><em>multidms.Data</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><em>dict</em></a>) – Either a single <cite>multidms.Data</cite> object or a dictionary of
replicate fits where the keys are the replicate names and the values
are the respective model objects.</p></li>
<li><p><strong>biochem_order_aas</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – Biochemically order amino-acid alphabet <code class="xref py py-attr docutils literal notranslate"><span class="pre">PolyclonalCollection.alphabet</span></code>
by passing it through <code class="xref py py-func docutils literal notranslate"><span class="pre">polyclonal.alphabets.biochem_order_aas()</span></code>.</p></li>
<li><p><strong>times_seen_threshold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – Set a threshold for the number of genetic backgrounds each mutant must be seen
within each condition in order to be used in the visualization.</p></li>
<li><p><strong>include_beta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – If True, include the beta values as another category in the figure.
If False, only include beta’s in the tooltip.</p></li>
<li><p><strong>**kwargs</strong> – Keyword args for <code class="xref py py-func docutils literal notranslate"><span class="pre">polyclonal.plot.lineplot_and_heatmap()</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Interactive heat maps.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>altair.Chart</p>
</dd>
</dl>
</dd></dl>



          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="index.html">
    <img class="logo" src="_static/2020-logo-1000px-transparent.png" alt="Logo"/>
    
    <h1 class="logo logo-name">multidms</h1>
    
  </a>
</p>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=matsengrp&repo=multidms&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html">multidms documentation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="biophysical_model.html">Biophysical model</a></li>
<li class="toctree-l1"><a class="reference internal" href="fit_delta_BA1_example.html"><code class="docutils literal notranslate"><span class="pre">multidms</span></code> fitting pipeline</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="multidms.html">multidms package</a></li>
<li class="toctree-l1"><a class="reference internal" href="acknowledgments.html">Acknowledgments</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="multidms.html">multidms package</a><ul>
      <li>Previous: <a href="multidms.model.html" title="previous chapter">model</a></li>
      <li>Next: <a href="multidms.utils.html" title="next chapter">Utils</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, Jared Galloway, Hugh Haddox.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.0.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="_sources/multidms.plot.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>